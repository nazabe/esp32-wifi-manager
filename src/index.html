<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>ESP32 WiFi Manager</title>
    <link rel="stylesheet" href="style.css">
    <!-- Carga de fuentes desde Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
    <script async src="code.js"></script>
</head>
<body>

    <main id="app">

        <!-- Vista Principal: Lista de Redes -->
        <div id="wifi" class="view">
            <div class="card">
                <header>
                    <h1>Configuración Wi-Fi</h1>
                </header>
                <div class="card-body">
                    <div id="wifi-status" class="wifi-status-connected">
                        <h2>Conectado a:</h2>
                        <section id="connected-to">
                            <!-- El JS insertará aquí la red conectada -->
                        </section>
                    </div>

                    <h2>Selecciona una red</h2>
                    <section id="wifi-list">
                        <!-- El JS llenará esta lista -->
                    </section>

                    <h2>O añade una red oculta</h2>
                    <section id="manual_add" class="wifi-list-item">
                        Añadir red manualmente (SSID oculto)
                    </section>
                </div>
                <footer>
                    <p><em>Powered by </em><a id="acredits" href="#"><strong>esp32-wifi-manager</strong></a>.</p>
                </footer>
            </div>
        </div>

        <!-- Vista: Conexión Manual -->
        <div id="connect_manual" class="view" style="display:none;">
            <div class="card">
                <header>
                    <h1>Conexión Manual</h1>
                </header>
                <form class="card-body" onsubmit="return false;">
                    <h2>Introduce los datos de la red</h2>
                    <div class="form-group">
                        <input id="manual_ssid" type="text" class="form-control" placeholder="Nombre de la red (SSID)">
                    </div>
                    <div class="form-group">
                        <input id="manual_pwd" type="password" class="form-control" placeholder="Contraseña">
                    </div>
                    <div class="form-group">
                        <input id="manual_togglepwd" class="btn btn-link" type="button" value="Mostrar contraseña">
                    </div>
                    <div class="button-group">
                        <input id="manual_cancel" type="button" value="Cancelar" class="btn btn-secondary">
                        <input id="manual_join" type="button" value="Conectar" class="btn btn-primary" data-connect="manual">
                    </div>
                </form>
            </div>
        </div>

        <!-- Vista: Ingresar Contraseña -->
        <div id="connect" class="view" style="display:none;">
            <div class="card">
                <header>
                    <h1>Ingresar Contraseña</h1>
                </header>
                <form class="card-body" onsubmit="return false;">
                    <h2>Contraseña para <span id="ssid-pwd"></span></h2>
                    <div class="form-group">
                        <input id="pwd" type="password" class="form-control" placeholder="Contraseña">
                    </div>
                     <div class="form-group">
                        <input id="togglepwd" class="btn btn-link" type="button" value="Mostrar contraseña">
                    </div>
                    <div class="button-group">
                        <input id="cancel" type="button" value="Cancelar" class="btn btn-secondary">
                        <input id="join" type="button" value="Conectar" class="btn btn-primary">
                    </div>
                </form>
            </div>
        </div>

        <!-- Vista: Esperando Conexión -->
        <div id="connect-wait" class="view" style="display:none;">
            <div class="card">
                <header>
                    <h1>Conectando...</h1>
                </header>
                <div class="card-body text-center">
                    <h2>Intentando conectar a <span id="ssid-wait"></span></h2>
                    
                    <div id="loading">
                        <div class="spinner"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>
                        <p>Puedes perder la conexión temporalmente mientras el ESP32 se conecta a la red. Por favor, espera.</p>
                    </div>

                    <div id="connect-success" style="display:none;">
                        <h3 class="text-success">¡Conexión exitosa!</h3>
                    </div>

                    <div id="connect-fail" style="display:none;">
                        <h3 class="text-danger">Falló la conexión</h3>
                        <p>Verifica la contraseña y que la señal de la red sea buena.</p>
                    </div>

                    <div class="button-group-center">
                        <input id="ok-connect" type="button" value="OK" class="btn btn-primary">
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista: Detalles de Conexión -->
        <div id="connect-details" class="view" style="display:none;">
             <div class="card">
                <header>
                    <h1 id="details-ssid"></h1>
                </header>
                <div class="card-body">
                    <h2>Detalles de la Conexión</h2>
                    <div class="connection-details">
                        <div class="detail-item"><span>Dirección IP</span><strong id="ip"></strong></div>
                        <div class="detail-item"><span>Máscara de Subred</span><strong id="netmask"></strong></div>
                        <div class="detail-item"><span>Gateway</span><strong id="gw"></strong></div>
                    </div>
                    <div class="button-group-center">
                        <input id="disconnect" type="button" value="Desconectar" class="btn btn-danger"/>
                        <input id="ok-details" type="button" value="OK" class="btn btn-secondary"/>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <!-- Conservamos los iconos SVG como datos para no requerir archivos externos -->
    <style>
        .w0{background:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxwYXRoIGQ9Ik0xLDlMMywxMUM3Ljk3LDYuMDMgMTYuMDMsNi4wMyAyMSwxMUwyMyw5QzE2LjkzLDIuOTMgNy4wOCwyLjkzIDEsOVoiIHN0eWxlPSJmaWxsOiBibGFjazsiLz4KPHBhdGggZD0iTTUsMTNMNywxNUM5Ljc2LDEyLjI0IDE0LjI0LDEyLjI0IDE3LDE1TDE5LDEzQzE1LjE0LDkuMTQgOC44Nyw5LjE0IDUsMTNaIiBzdHlsZT0iZmlsbDogYmxhY2s7Ii8+CjxwYXRoIGQ9Ik05LDE3TDEyLDIwTDE1LDE3QzEzLjM1LDE1LjM0IDEwLjY2LDE1LjM0IDksMTdaIiBzdHlsZT0iZmlsbDogYmxhY2s7Ii8+Cjwvc3ZnPgo=') no-repeat right top}.w1{background:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxwYXRoIGQ9Ik0xLDlMMywxMUM3Ljk3LDYuMDMgMTYuMDMsNi4wMyAyMSwxMUwyMyw5QzE2LjkzLDIuOTMgNy4wOCwyLjkzIDEsOVoiIHN0eWxlPSJmaWxsOiBncmF5OyIvPgo8cGF0aCBkPSJNNSwxM0w3LDE1QzkuNzYsMTIuMjQgMTQuMjQsMTIuMjQgMTcsMTVMMTksMTNDMTUuMTQsOS4xNCA4Ljg3LDkuMTQgNSwxM1oiIHN0eWxlPSJmaWxsOiBibGFjazsiLz4KPHBhdGggZD0iTTksMTdMMTIsMjBMMTUsMTdDMTMuMzUsMTUuMzQgMTAuNjYsMTUuMzQgOSwxN1daIiBzdHlsZT0iZmlsbDogYmxhYszs7Ii8+Cjwvc3ZnPgo=') no-repeat right top}.w2{background:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxwYXRoIGQ9Ik0xLDlMMywxMUM3Ljk3LDYuMDMgMTYuMDMsNi4wMyAyMSwxMUwyMyw5QzE2LjkzLDIuOTMgNy4wOCwyLjkzIDEsOVoiIHN0eWxlPSJmaWxsOiBncmF5OyIvPgo8cGF0aCBkPSJNNSwxM0w3LDE1QzkuNzYsMTIuMjQgMTQuMjQsMTIuMjQgMTcsMTVMMTksMTNDMTUuMTQsOS4xNCA4Ljg3LDkuMTQgNSwxM1oiIHN0eWxlPSJmaWxsOiBncmF5OyIvPgo8cGF0aCBkPSJNOSwxN0wxMiwyMEwxNSwxN0MxMy4zNSwxNS4zNCAxMC42NiwxNS4zNCA5LDE3WiIgc3R5bGU9ImZpbGw6IGJsYWNrOyIvPgo8L3N2Zz4K') no-repeat right top}.w3{background:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxwYXRoIGQ9Ik0xLDlMMywxMUM3Ljk3LDYuMDMgMTYuMDMsNi4wMyAyMSwxMUwyMyw5QzE2LjkzLDIuOTMgNy4wOCwyLjkzIDEsOVoiIHN0eWxlPSJmaWxsOiBncmF5OyIvPgo8cGF0aCBkPSJNNSwxM0w3LDE1QzkuNzYsMTIuMjQgMTQuMjQsMTIuMjQgMTcsMTVMMTksMTNDMTUuMTQsOS4xNCA4Ljg3LDkuMTQgNSwxM1oiIHN0eWxlPSJmaWxsOiBncmF5OyIvPgo8cGF0aCBkPSJNOSwxN0wxMiwyMEwxNSwxN0MxMy4zNSwxNS4zNCAxMC42NiwxNS4zNCA5LDE3WiIgc3R5bGU9ImZpbGw6IGdyYXk7Ii8+Cjwvc3ZnPgo=') no-repeat right top}.pw{background:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+Cjxzdmcgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxwYXRoIHN0eWxlPSJmaWxsOiBibGFjazsiIGQ9Ik0xOCA4aC0xVjZjMC0yLjc2LTIuMjQtNS01LTVTNyAzLjI0IDcgNnYySDZjLTEuMSAwLTIgLjktMiAydjEwYzAgMS4xLjkgMiAyIDJoMTJjMS4xIDAgMi0uOSAyLTJWMTBjMC0xLjEtLjktMi0yLTJ6bS02IDljLTEuMSAwLTItLjktMi0ycy45LTIgMi0yIDIgLjkgMiAyLS45IDItMiAyem0zLjEtOUg4LjlWNmMwLTEuNzEgMS4zOS0zLjEgMy4xLTMuMSAxLjcxIDAgMy4xIDEuMzkgMy4xIDMuMXYyeiI+PC9wYXRoPgo8L3N2Zz4=') no-repeat right top}
    </style>
</body>
</html>